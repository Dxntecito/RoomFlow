{% extends "Master.html" %}

{% block stiles %}
<link rel="stylesheet" href="../../Static/CSS/Empleados.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&display=swap"
    rel="stylesheet">
{% endblock %}

{% block content %}
<div class="empleados-container">
    <!-- Header con título y botón regresar -->
    <div class="page-header-simple">
        <h1 class="page-title">MÓDULO DE EMPLEADOS</h1>
        <h2 class="page-subtitle">Actualizar datos de empleado</h2>
        <a href="{{ url_for('empleados.Empleados') }}" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Regresar
        </a>
    </div>

    <!-- Formulario principal -->
    <div class="form-container-large">
        <div class="form-section-header">
            <h3 class="form-section-title">DATOS DE EMPLEADO</h3>
        </div>

        <form method="POST" class="empleado-form-large">
            <div class="form-row-large">
                <div class="form-group-large">
                    <label for="ape_paterno" class="form-label-large">Apellido paterno</label>
                    <input type="text" id="ape_paterno" name="ape_paterno" class="form-input-large"
                        value="{{ empleado[3] }}" required>
                </div>
                <div class="form-group-large">
                    <label for="ape_materno" class="form-label-large">Apellido materno</label>
                    <input type="text" id="ape_materno" name="ape_materno" class="form-input-large"
                        value="{{ empleado[4] }}" required>
                </div>
                <div class="form-group-large">
                    <label for="nombres" class="form-label-large">Nombres</label>
                    <input type="text" id="nombres" name="nombres" class="form-input-large" value="{{ empleado[5] }}"
                        required>
                </div>
                <div class="form-group-large">
                    <label for="dni" class="form-label-large">DNI</label>
                    <input type="text" id="dni" name="dni" class="form-input-large" value="{{ empleado[2] }}"
                        maxlength="8" required>
                </div>
            </div>

            <div class="form-row-large">
                <div class="form-group-large">
                    <label for="estado" class="form-label-large">Estado</label>
                    <div class="status-container">
                        <input type="text" id="estado" name="estado" class="form-input-large status-input"
                            value="Activo" readonly>
                        <i class="fas fa-link status-icon"></i>
                    </div>
                </div>
                <div class="form-group-large">
                    <label for="movil" class="form-label-large">Teléfono</label>
                    <input type="text" id="movil" name="movil" class="form-input-large" value="{{ empleado[7] }}"
                        maxlength="9" required>
                </div>
                <div class="form-group-large">
                    <label for="sexo" class="form-label-large">Sexo</label>
                    <select id="sexo" name="sexo" class="form-select-large" required>
                        <option value="M" {% if empleado[6]=='M' %}selected{% endif %}>Masculino</option>
                        <option value="F" {% if empleado[6]=='F' %}selected{% endif %}>Femenino</option>
                    </select>
                </div>
                <div class="form-group-large">
                    <label for="tipo_empleado_id" class="form-label-large">Rol</label>
                    <select id="tipo_empleado_id" name="tipo_empleado_id" class="form-select-large" required>
                        {% for tipo in tipos_empleado %}
                        <option value="{{ tipo[0] }}" {% if tipo[0]==empleado[8] %}selected{% endif %}>{{ tipo[1] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="form-actions-large">
                <button type="submit" class="save-button-large">
                    <i class="fas fa-save"></i>
                    Guardar
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Mensajes flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<div class="flash-messages">
    {% for category, message in messages %}
    <div class="flash-message flash-{{ category }}">
        <i
            class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'error' %}exclamation-circle{% else %}info-circle{% endif %}"></i>
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}

<script>
    // Auto-hide flash messages
    document.addEventListener('DOMContentLoaded', function () {
        const flashMessages = document.querySelectorAll('.flash-message');
        flashMessages.forEach(function (message) {
            setTimeout(function () {
                message.style.opacity = '0';
                setTimeout(function () {
                    message.remove();
                }, 300);
            }, 5000);
        });
    });

    // Validación de DNI (solo números)
    document.getElementById('dni').addEventListener('input', function (e) {
        this.value = this.value.replace(/[^0-9]/g, '');
    });

    // Validación de teléfono (solo números)
    document.getElementById('movil').addEventListener('input', function (e) {
        this.value = this.value.replace(/[^0-9]/g, '');
    });
</script>
{% endblock content %}